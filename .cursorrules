# Project: Pomodoro Focus Workbench

# Technical Stack
- Framework: React (Vite)
- Language: TypeScript
- Styling: Tailwind CSS
- Icons: @phosphor-icons/react
- Backend/Database: Supabase
- State Management: React Hooks + Context API (PomodoroContext)
- PWA: vite-plugin-pwa

# Code Style
- Components: Must use Functional Components.
- State: Must use React Hooks (useState, useEffect, useMemo, useCallback, useRef, etc.).
- Styling: Use Tailwind CSS utility classes exclusively. Avoid creating new CSS files or using inline styles unless absolutely necessary.
- Naming Conventions:
  - Components & Files: PascalCase (e.g., `TodoList.tsx`, `ThemedCard.tsx`, `Timer.tsx`).
  - Logic/Hooks/Utils: camelCase (e.g., `usePomodoro.ts`, `supabase.ts`).
  - Context Hooks: camelCase with Context suffix (e.g., `usePomodoroContext.tsx`).
  - Constants: UPPER_SNAKE_CASE (e.g., `DEFAULT_CONFIG`, `PHASE_STYLES`).
- Types: Explicitly define interfaces/types for props and data structures (refer to `src/types.ts`).

# Design System (Material Design 3 Inspired)
- **Aesthetic**: Modern, clean, spacious, "Google-like".
- **Shapes**: Generous rounded corners (`rounded-3xl` for cards, `rounded-full` for buttons/inputs/pills).
- **Typography**: Large, bold headings (`text-5xl`, `text-3xl`), legible body text (`text-base`), readable inputs (`text-lg`).
- **Visuals**: 
  - Circular Timer Ring (SVG) with breathing animation (`animate-pulse-slow`).
  - Soft shadows (`shadow-xl`, `shadow-stone-200/50`).
  - Minimalist color palette: Stone (Base), Amber (Focus), Emerald (Short Break), Amber/Orange (Long Break).
- **Interactions**: Smooth transitions, hover effects (scale/lift), drag-and-drop for files.

# Project Structure
```
src/
├── App.tsx                 # Main Layout (Grid: Timer | TodoList)
├── main.tsx                # Entry Point
├── index.css               # Global Styles (Tailwind + Scrollbar)
├── supabase.ts             # Supabase Client
├── types.ts                # Shared Types
├── assets/                 # Static Assets
├── components/             # UI Components
│   ├── InstallPrompt.tsx   # PWA Install
│   ├── LoginPage.tsx       # Auth Page
│   ├── NoisePlayer.tsx     # White Noise (Currently hidden)
│   ├── ThemedCard.tsx      # Standard Card Container
│   ├── Timer.tsx           # Circular Pomodoro Timer
│   ├── TodoList.tsx        # Advanced Task List (Subtasks, Tags, Due Date)
│   ├── TomatoProgress.tsx  # Progress Icon
│   ├── UserMenu.tsx        # User Profile
│   ├── Statistics.tsx      # Stats Dashboard
│   ├── Heatmap.tsx         # Focus Heatmap
│   ├── ReportCard.tsx      # Stats Report
│   ├── TaskHistory.tsx     # Completed Tasks
│   ├── Transfer.tsx        # Cross-device File Transfer
│   └── Settings.tsx        # User Preferences
└── hooks/                  # Custom Hooks
    ├── useAuth.ts          # Authentication
    ├── usePomodoro.ts      # Timer Logic
    ├── usePomodoroContext.tsx  # Global Context
    ├── useTheme.ts         # Dark/Light Mode
    ├── useStatistics.ts    # Stats Data Fetching (Optimized)
    ├── useTransfers.ts     # File Transfer Logic (Optimized)
    ├── useSettings.ts      # Settings Management
    ├── useNotifications.ts # Browser Notifications
    └── useKeyboardShortcuts.ts # Hotkeys
```

# Database Schema (Supabase)

## Tables
- **todos**: 
  - `id` (UUID), `text`, `completed`, `pomodoros` (count), `tags` (array), `priority` (low/med/high), `estimated_time` (int), `due_date` (timestamp), `subtasks` (jsonb), `transfer_ids` (array), `user_id`, `created_at`, `completed_at`.
- **pomodoro_sessions**: 
  - `id` (UUID), `user_id`, `task_id`, `date`, `duration_seconds`, `phase`, `created_at`.
- **user_settings**: 
  - `user_id`, `focus_duration`, `short_break_duration`, `long_break_duration`, `auto_start_focus`, `auto_start_break`, `tag_color_mode`.
- **transfers**: 
  - `id` (UUID), `user_id`, `type` (text/image/video/audio/doc), `content` (path/text), `metadata` (jsonb), `created_at`.

# Key Features
1.  **Timer**: Circular visual progress, custom durations, phase switching, auto-start options.
2.  **Todo List**: 
    - Add tasks with Priority, Estimate, Tags, Due Date.
    - Subtasks (editable, deletable).
    - Link files from Transfer to Tasks.
    - Drag & Drop sorting (planned/implied).
3.  **Statistics**: Weekly/Monthly reports, Heatmap, efficiency analysis.
4.  **Transfer**: Cross-platform file sharing via Supabase Storage with signed URLs.
5.  **Theming**: System/Manual Dark Mode support.

# Development Guidelines
- **Performance**: 
  - Use `React.lazy` for non-critical tabs (Statistics, Transfer, Settings).
  - Batch API calls (e.g., `createSignedUrls` in Transfer).
  - Consolidated queries (e.g., Statistics fetching).
- **Database**: Use RPCs where possible for complex aggregations.
- **UX**: Prioritize "Optimistic UI" updates for responsiveness.
